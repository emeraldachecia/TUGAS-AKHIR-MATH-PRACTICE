<div class="dashboard-page">
    <!-- data user -->
    <script id="dataUser" type="application/json">
		<%- JSON.stringify(user) %>
	</script>

    <script id="dataDashboard" type="application/json">
		<%- JSON.stringify(data) %>
	</script>

    <!-- ====================== STUDENT DASHBOARD ======================= -->
    <% if (user.role==='student' ) { %>
        <section id="studentDashboard">
            <div class="main-card main-card-overall">
                <h2 class="main-card-title">Performa Keseluruhan</h2>

                <div class="overall-grid">
                    <div class="child-card">
                        <span class="child-label">Total Latihan</span>
                        <span class="child-number">
                            <%= data.overall.total_exercise %>
                        </span>
                    </div>

                    <div class="child-card">
                        <span class="child-label">Rata-rata Nilai</span>
                        <span class="child-number">
                            <%= data.overall.average_score %>
                        </span>
                    </div>

                    <div class="child-card">
                        <span class="child-label">Total Nilai</span>
                        <span class="child-number">
                            <%= data.overall.total_score %>
                        </span>
                    </div>
                </div>
            </div>

            <div class="dashboard-row">
                <div class="main-card main-card-topic">
                    <h2 class="main-card-title">Aritmatika</h2>

                    <div class="topic-summary">
                        <span>Total Latihan:
                            <strong>
                                <%= data.arithmetic.total_exercise %>
                            </strong></span>
                        <span>Total Nilai:
                            <strong>
                                <%= data.arithmetic.total_score %>
                            </strong></span>
                        <span>Rata-rata Nilai:
                            <strong>
                                <%= data.arithmetic.average_score %>
                            </strong></span>
                    </div>

                    <div class="topic-levels">
                        <!-- EASY -->
                        <div class="level-card level-easy">
                            <div class="level-title">Mudah</div>
                            <div class="level-content">
                                <span>Total Latihan:
                                    <strong>
                                        <%= data.arithmetic.easy.total_exercise %>
                                    </strong></span>
                                <span>Total Nilai:
                                    <strong>
                                        <%= data.arithmetic.easy.total_score %>
                                    </strong></span>
                                <span>Rata-rata Nilai:
                                    <strong>
                                        <%= data.arithmetic.easy.average_score %>
                                    </strong></span>
                            </div>
                        </div>

                        <!-- MEDIUM -->
                        <div class="level-card level-medium">
                            <div class="level-title">Sedang</div>
                            <div class="level-content">
                                <span>Total Latihan:
                                    <strong>
                                        <%= data.arithmetic.medium.total_exercise %>
                                    </strong></span>
                                <span>Total Nilai:
                                    <strong>
                                        <%= data.arithmetic.medium.total_score %>
                                    </strong></span>
                                <span>Rata-rata Nilai:
                                    <strong>
                                        <%= data.arithmetic.medium.average_score %>
                                    </strong></span>
                            </div>
                        </div>

                        <!-- HARD -->
                        <div class="level-card level-hard">
                            <div class="level-title">Sulit</div>
                            <div class="level-content">
                                <span>Total Latihan:
                                    <strong>
                                        <%= data.arithmetic.hard.total_exercise %>
                                    </strong></span>
                                <span>Total Nilai:
                                    <strong>
                                        <%= data.arithmetic.hard.total_score %>
                                    </strong></span>
                                <span>Rata-rata Nilai:
                                    <strong>
                                        <%= data.arithmetic.hard.average_score %>
                                    </strong></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="main-card main-card-topic">
                    <h2 class="main-card-title">Bangun Datar</h2>

                    <div class="topic-summary">
                        <span>Total Latihan:
                            <strong>
                                <%= data.geometry.total_exercise %>
                            </strong></span>
                        <span>Total Nilai:
                            <strong>
                                <%= data.geometry.total_score %>
                            </strong></span>
                        <span>Rata-rata Nilai:
                            <strong>
                                <%= data.geometry.average_score %>
                            </strong></span>
                    </div>

                    <div class="topic-levels">
                        <!-- EASY -->
                        <div class="level-card level-easy">
                            <div class="level-title">Mudah</div>
                            <div class="level-content">
                                <span>Total Latihan:
                                    <strong>
                                        <%= data.geometry.easy.total_exercise %>
                                    </strong></span>
                                <span>Total Nilai:
                                    <strong>
                                        <%= data.geometry.easy.total_score %>
                                    </strong></span>
                                <span>Rata-rata Nilai:
                                    <strong>
                                        <%= data.geometry.easy.average_score %>
                                    </strong></span>
                            </div>
                        </div>

                        <!-- MEDIUM -->
                        <div class="level-card level-medium">
                            <div class="level-title">Sedang</div>
                            <div class="level-content">
                                <span>Total Latihan:
                                    <strong>
                                        <%= data.geometry.medium.total_exercise %>
                                    </strong></span>
                                <span>Total Nilai:
                                    <strong>
                                        <%= data.geometry.medium.total_score %>
                                    </strong></span>
                                <span>Rata-rata Nilai:
                                    <strong>
                                        <%= data.geometry.medium.average_score %>
                                    </strong></span>
                            </div>
                        </div>

                        <!-- HARD -->
                        <div class="level-card level-hard">
                            <div class="level-title">Sulit</div>
                            <div class="level-content">
                                <span>Total Latihan:
                                    <strong>
                                        <%= data.geometry.hard.total_exercise %>
                                    </strong></span>
                                <span>Total Nilai:
                                    <strong>
                                        <%= data.geometry.hard.total_score %>
                                    </strong></span>
                                <span>Rata-rata Nilai:
                                    <strong>
                                        <%= data.geometry.hard.average_score %>
                                    </strong></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <% } %>

            <!-- ====================== ADMIN DASHBOARD ====================== -->
            <% if (user.role==='admin' ) { %>
                <section id="adminDashboard">
                    <h2 class="admin-title">Statistik Admin</h2>

                    <div class="admin-grid">
                        <div class="admin-card">
                            <span class="admin-label">Total Pengguna</span>
                            <span class="admin-number">
                                <%= data.total_users %>
                            </span>
                        </div>

                        <div class="admin-card">
                            <span class="admin-label">Template</span>
                            <span class="admin-number">
                                <%= data.total_templates %>
                            </span>
                        </div>

                        <div class="admin-card">
                            <span class="admin-label">Latihan Dihasilkan</span>
                            <span class="admin-number">
                                <%= data.total_exercises %>
                            </span>
                        </div>

                        <div class="admin-card">
                            <span class="admin-label">Rata-rata Nilai</span>
                            <span class="admin-number">
                                <%= data.avg_score_all %>
                            </span>
                        </div>
                    </div>

                    <h3 class="top10-title">10 Mahasiswa Terbaik</h3>
                    <table class="top10-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Mahasiswa</th>
                                <th>Total Nilai</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if (data.top10 && data.top10.length> 0) { %>
                                <% data.top10.forEach((s, i)=> { %>
                                    <tr>
                                        <td>
                                            <%= i + 1 %>
                                        </td>
                                        <td>
                                            <%= s.name %>
                                        </td>
                                        <td>
                                            <%= s.total_score %>
                                        </td>
                                    </tr>
                                    <% }) %>
                                        <% } else { %>
                                            <tr>
                                                <td colspan="3">Tidak ada data</td>
                                            </tr>
                                            <% } %>
                        </tbody>
                    </table>
                </section>
                <% } %>
</div>